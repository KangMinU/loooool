<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í™”ì´íŠ¸ë°ì´ ë°ì´íŠ¸?</title>
  <style>
    :root {
      --btn-w: 160px;
      --btn-h: 56px;
      --card-w: 680px;
    }

    * { box-sizing: border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
      background:#fff;
      overflow:hidden;
    }

    .wrap{
      width:min(var(--card-w), 92vw);
      padding:28px 22px;
      border:1px solid #eee;
      border-radius:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.06);
      text-align:center;
      background: #fff;
      position: relative;
      z-index: 2;
    }

    h1{
      font-size: 22px;
      margin:0 0 10px;
      line-height:1.35;
    }

    p{
      margin:0 0 18px;
      color:#444;
      line-height:1.5;
    }

    .stage{
      position: relative;
      height: 240px;
      border-radius: 14px;
      border: 1px dashed #e7e7e7;
      background: #fafafa;
      overflow: hidden;
      touch-action: none; /* ëª¨ë°”ì¼ ì œìŠ¤ì²˜ ê°„ì„­ ìµœì†Œí™” */
    }

    button{
      width: var(--btn-w);
      height: var(--btn-h);
      border:0;
      border-radius: 14px;
      font-size: 18px;
      cursor: pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }

    #yes{
      position:absolute;
      left: 18%;
      top: 42%;
      background:#ff3b82;
      color:white;
      box-shadow: 0 10px 20px rgba(255,59,130,.25);
    }

    #no{
      position:absolute;
      left: 58%;
      top: 42%;
      background:#111;
      color:white;
      will-change: left, top, transform;
      transition: transform 120ms ease;
    }

    .hint{
      margin-top:10px;
      font-size:13px;
      color:#666;
    }

    /* âœ… Yes ëˆ„ë¥´ë©´ í˜ì´ì§€ ì „í™˜ */
    .screen{
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: #fff;
      opacity: 0;
      pointer-events: none;
      transition: opacity 320ms ease;
      z-index: 3;
    }
    .screen.on{
      opacity: 1;
      pointer-events: auto;
    }
    .screen .msg{
      width:min(720px, 92vw);
      padding: 28px 22px;
      border:1px solid #eee;
      border-radius:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.06);
      text-align:center;
      background:#fff;
    }
    .screen h2{
      margin:0 0 10px;
      font-size: 22px;
      color:#ff3b82;
    }
    .screen p{
      margin:0;
      color:#333;
      font-size:16px;
    }

    /* âœ… í­ì£½ ìº”ë²„ìŠ¤ */
    canvas#fx{
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
    }
  </style>
</head>

<body>
  <canvas id="fx"></canvas>

  <div class="wrap" id="mainCard">
    <!-- âœï¸ [ë¬¸êµ¬ ìˆ˜ì • ìœ„ì¹˜ 1] ì•„ë˜ ì œëª©/ë¬¸ì¥ë§Œ ë°”ê¾¸ë©´ ë¨ -->
    <h1><!-- TODO: ì œëª© ìˆ˜ì • -->ë°œë Œíƒ€ì¸ë°ì´ì—ëŠ” ëª» ë§Œë‚¬ì§€ë§Œ<br/>í™”ì´íŠ¸ë°ì´ì— ê°™ì´ ë°ì´íŠ¸ í• ë˜?</h1>
    <p><!-- TODO: ì„¤ëª… ìˆ˜ì • -->Yes / No ì¤‘ì— ê³¨ë¼ì¤˜ ğŸ™‚</p>

    <div class="stage" id="stage">
      <button id="yes" type="button">Yes</button>
      <button id="no" type="button">No</button>
    </div>

    <div class="hint"><!-- TODO: íŒíŠ¸ ìˆ˜ì •(ì›í•˜ë©´) -->NoëŠ”â€¦ ì„ íƒ ë¶ˆê°€ ğŸ˜</div>
  </div>

  <!-- âœ… Yes ëˆ„ë¥´ë©´ ì „í™˜ë˜ëŠ” í™”ë©´ -->
  <div class="screen" id="successScreen" aria-hidden="true">
    <div class="msg">
      <!-- âœï¸ [ë¬¸êµ¬ ìˆ˜ì • ìœ„ì¹˜ 2] Yes ì„±ê³µ ì‹œ ì œëª©/ë¬¸ì¥ -->
      <h2><!-- TODO: ì„±ê³µ ì œëª© ìˆ˜ì • -->â¤ï¸ ìš°ë¦¬ í™”ì´íŠ¸ë°ì´ ë°ì´íŠ¸ í™•ì • â¤ï¸</h2>
      <p><!-- TODO: ì„±ê³µ ì„¤ëª… ìˆ˜ì • -->ë‚ ì§œ/ì‹œê°„/ì¥ì†ŒëŠ” ì—°ë½ìœ¼ë¡œ ì •í•˜ì ğŸ™‚</p>
    </div>
  </div>

  <script>
    const stage = document.getElementById("stage");
    const yes = document.getElementById("yes");
    const no = document.getElementById("no");
    const successScreen = document.getElementById("successScreen");

    // ====== No ë²„íŠ¼ "ì ˆëŒ€ í´ë¦­ ë¶ˆê°€" êµ¬í˜„ ======

    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

    function getPosInStage(evt){
      const s = stage.getBoundingClientRect();
      const e = evt.touches?.[0] ?? evt.changedTouches?.[0] ?? evt;
      return { x: e.clientX - s.left, y: e.clientY - s.top };
    }

    function placeNoRandom(){
      const s = stage.getBoundingClientRect();
      const b = no.getBoundingClientRect();
      const pad = 10;
      const left = Math.random() * (s.width  - b.width  - pad*2) + pad;
      const top  = Math.random() * (s.height - b.height - pad*2) + pad;
      no.style.left = left + "px";
      no.style.top  = top  + "px";
    }

    // ë„ë§ ë¡œì§: í¬ì¸í„° ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ "ë°˜ëŒ€ ë°©í–¥"ìœ¼ë¡œ ì´ë™ + í´ë¨í”„
    function runAwayFrom(x, y){
      const s = stage.getBoundingClientRect();
      const b = no.getBoundingClientRect();
      const pad = 10;

      const btnW = b.width, btnH = b.height;
      const curLeft = (b.left - s.left);
      const curTop  = (b.top  - s.top);

      const noCx = curLeft + btnW/2;
      const noCy = curTop  + btnH/2;

      let dx = noCx - x;
      let dy = noCy - y;

      // 0ë²¡í„° ë°©ì§€
      const len0 = Math.hypot(dx, dy);
      if (len0 < 0.5){
        dx = (Math.random() - 0.5);
        dy = (Math.random() - 0.5);
      }

      // normalize
      const len = Math.hypot(dx, dy);
      dx /= len; dy /= len;

      // âœ… ëª¨ë°”ì¼ì—ì„œ "ì°ëŠ” ìˆœê°„"ë„ ëª» ëˆ„ë¥´ê²Œ: ì¶©ë¶„íˆ í¬ê²Œ ì í”„
      const dist = clamp(Math.min(s.width, s.height) * 0.55, 160, 280);

      let newLeft = curLeft + dx * dist + (Math.random()-0.5)*50;
      let newTop  = curTop  + dy * dist + (Math.random()-0.5)*35;

      newLeft = clamp(newLeft, pad, s.width  - btnW - pad);
      newTop  = clamp(newTop,  pad, s.height - btnH - pad);

      // í˜¹ì‹œ ê°™ì€ ìœ„ì¹˜ ê·¼ì²˜ë¡œ ë‹¤ì‹œ ê°€ëŠ” ê±¸ ë°©ì§€: ë„ˆë¬´ ê°€ê¹Œìš°ë©´ ì¬ë°°ì¹˜
      if (Math.hypot(newLeft - curLeft, newTop - curTop) < 40){
        newLeft = Math.random() * (s.width  - btnW - pad*2) + pad;
        newTop  = Math.random() * (s.height - btnH - pad*2) + pad;
      }

      no.style.left = newLeft + "px";
      no.style.top  = newTop  + "px";

      no.style.transform = "scale(1.08)";
      setTimeout(() => no.style.transform = "scale(1)", 120);
    }

    // âœ… 1) ê°€ê¹Œì›Œì§€ë©´ ë„ë§ (PC: mousemove, ëª¨ë°”ì¼: touchmove)
    const TRIGGER_RADIUS = 120; // í•„ìš”í•˜ë©´ ì—¬ê¸°ë§Œ ì¡°ì ˆ
    function maybeRunAway(evt){
      const { x, y } = getPosInStage(evt);
      const s = stage.getBoundingClientRect();
      const b = no.getBoundingClientRect();
      const cx = (b.left - s.left) + b.width/2;
      const cy = (b.top  - s.top ) + b.height/2;
      if (Math.hypot(x - cx, y - cy) < TRIGGER_RADIUS){
        runAwayFrom(x, y);
      }
    }
    stage.addEventListener("mousemove", maybeRunAway);
    stage.addEventListener("touchmove", maybeRunAway, { passive: true });

    // âœ… 2) ì˜¬ë¦¬ê¸°ë§Œ í•´ë„(hover) ë„ë§
    no.addEventListener("mouseenter", (evt) => {
      const { x, y } = getPosInStage(evt);
      runAwayFrom(x, y);
    });

    // âœ… 3) ëª¨ë°”ì¼ í¬í•¨: "ëˆ„ë¥´ëŠ” ìˆœê°„(pointerdown)"ì— ë¬´ì¡°ê±´ ë„ë§ + ì´ë²¤íŠ¸ ì°¨ë‹¨
    // ìº¡ì²˜ ë‹¨ê³„(true)ë¡œ ë¨¼ì € ì¡ì•„ë²„ë ¤ì„œ í´ë¦­ì´ ì ˆëŒ€ ì„±ë¦½ ëª» í•˜ê²Œ í•¨
    no.addEventListener("pointerdown", (evt) => {
      evt.preventDefault();
      evt.stopPropagation();
      const { x, y } = getPosInStage(evt);
      runAwayFrom(x, y);
    }, true);

    // âœ… 4) í˜¹ì‹œë¼ë„ clickì´ ë°œìƒí•˜ë©´(ì´ë¡ ìƒ ê±°ì˜ ë¶ˆê°€) ì™„ì „ ì°¨ë‹¨
    no.addEventListener("click", (evt) => {
      evt.preventDefault();
      evt.stopPropagation();
      evt.stopImmediatePropagation();
      // ì¦‰ì‹œ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ë™
      const s = stage.getBoundingClientRect();
      runAwayFrom(Math.random()*s.width, Math.random()*s.height);
      return false;
    }, true);

    // ì´ˆê¸° ë°°ì¹˜(ë Œë” í›„)
    setTimeout(placeNoRandom, 0);
    window.addEventListener("resize", () => setTimeout(placeNoRandom, 0));

    // ====== Yes: í­ì£½ + í™”ë©´ ì „í™˜ ======

    // ê°„ë‹¨ íŒŒí‹°í´ í­ì£½ (ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´)
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d");

    function resizeCanvas(){
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
      canvas.style.width = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    let particles = [];
    let fxRunning = false;

    function spawnBurst(x, y){
      const n = 120;
      for (let i=0; i<n; i++){
        const a = Math.random() * Math.PI * 2;
        const sp = 2 + Math.random() * 6;
        particles.push({
          x, y,
          vx: Math.cos(a)*sp,
          vy: Math.sin(a)*sp,
          life: 60 + Math.random()*40,
          r: 2 + Math.random()*2.5,
          // ìƒ‰ ì§€ì •ì€ ì•ˆ í•´ë„ ë˜ì§€ë§Œ, í­ì£½ì€ ìƒ‰ì´ ìˆì–´ì•¼ ëŠë‚Œì´ ì‚´ì•„ì„œ ëœë¤ HSL ì‚¬ìš©
          hue: Math.floor(Math.random()*360)
        });
      }
    }

    function stepFx(){
      if (!fxRunning) return;

      ctx.clearRect(0,0,window.innerWidth, window.innerHeight);

      particles = particles.filter(p => p.life > 0);
      for (const p of particles){
        p.life -= 1;
        p.vy += 0.05;            // ì¤‘ë ¥
        p.vx *= 0.99;            // ê³µê¸°ì €í•­
        p.vy *= 0.99;

        p.x += p.vx;
        p.y += p.vy;

        const alpha = Math.max(0, Math.min(1, p.life / 90));
        ctx.beginPath();
        ctx.fillStyle = `hsla(${p.hue}, 95%, 55%, ${alpha})`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
      }

      requestAnimationFrame(stepFx);
    }

    function startFireworks(){
      fxRunning = true;
      particles = [];
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 2;

      // ì¤‘ì•™ + ëœë¤ ìœ„ì¹˜ë¡œ ëª‡ ë²ˆ ì—°ì† í„°íŠ¸ë¦¬ê¸°
      spawnBurst(cx, cy);
      setTimeout(() => spawnBurst(cx - 120, cy - 40), 200);
      setTimeout(() => spawnBurst(cx + 140, cy - 30), 420);
      setTimeout(() => spawnBurst(cx, cy + 60), 650);

      stepFx();

      // 3ì´ˆ í›„ ìë™ ì¢…ë£Œ(ì›í•˜ë©´ ëŠ˜ë ¤ë„ ë¨)
      setTimeout(() => { fxRunning = false; particles = []; ctx.clearRect(0,0,window.innerWidth, window.innerHeight); }, 3200);
    }

    yes.addEventListener("click", () => {
      startFireworks();
      // í™”ë©´ ì „í™˜
      successScreen.classList.add("on");
      successScreen.setAttribute("aria-hidden", "false");
    });
  </script>
</body>
</html>